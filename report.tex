\documentclass{scrartcl}
\usepackage{multicol}
\usepackage{epigraph}
\usepackage{url}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{color}
\usepackage[parfill]{parskip}
\usepackage{titlesec}
\usepackage{geometry}
\usepackage{todonotes}
\usepackage{hyperref}

\lstset{
breaklines=true,
breakautoindent=true,
postbreak=\space,
tabsize=2,
basicstyle=\ttfamily\footnotesize,
showspaces=false,
showstringspaces=false,
extendedchars=true,
}

\newcommand{\horizontalrule}[1]{\rule{\linewidth}{#1}}
\def\changemargin#1#2{\list{}{\rightmargin#2\leftmargin#1}\item[]}
\let\endchangemargin=\endlist

\newcounter{savepage}

\title{\horizontalrule{1pt}\\[0.5cm]Large-scale drive-by download detection: boot. visit$^n$. kill. repeat.}
\subtitle{Master in System and Network Engineering \\[0.5cm] \horizontalrule{1pt} }
\author{}
\date{}

\begin{document}
\pagenumbering{gobble}
\newgeometry{top=4cm,bottom=1cm}

\centerline{\includegraphics[width=10cm]{Images/UvA-logo-english}}

\begin{center}
\horizontalrule{1pt}\\[0.5cm]
\usekomafont{title}{\huge Large-scale drive-by download detection: \\[0.2cm] boot. visit$^n$. kill. repeat.}
\\[0.1cm]
\usekomafont{subtitle}{Master in System and Network Engineering} \\[0.5cm]
\horizontalrule{1pt} 
\end{center}

\vspace{7cm}

\begin{center}

\Large
Students:\\[0.5cm]

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \Large
Adriaan Dens\\\texttt{adriaan.dens@os3.nl}
\end{flushleft}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\begin{flushright} \Large
Martijn Bogaard\\\texttt{martijn.bogaard@os3.nl}
\end{flushright}
\end{minipage}\\[1.6cm]

\Large
Supervisors:\\[0.5cm]

\begin{minipage}{0.4\textwidth}
\begin{flushleft} \Large
Jop van der Lelie\\\texttt{jop.vanderlelie@ncsc.nl}
\end{flushleft}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\begin{flushright} \Large
Wouter Katz\\\texttt{wouter.katz@ncsc.nl}
\end{flushright}
\end{minipage}\\[1.6cm]

{\Large \today}
\end{center}

\clearpage
\restoregeometry

\section*{Abstract}

Current malware analysis systems do not allow for concurrently visiting multiple websites. In this paper we present an algorithm which solves this problem by extensive monitoring of the environment. Additionally, a proof of concept has been developed which implements this algorithm. Results show a X decrease in time and ... against current systems.

\clearpage

\tableofcontents

\clearpage

\pagenumbering{arabic}

\section{Introduction}
\input{Chapters/01_Introduction.tex}

\clearpage

\section{Theory}
\input{Chapters/02_Background.tex}

\clearpage

\section{Approach and Methods}
\input{Chapters/03_Methodology.tex}

\clearpage

\section{Results}
\input{Chapters/04_Results.tex}

\clearpage

\section{Conclusion}
\input{Chapters/99_Conclusion.tex}

\clearpage

\section{Future work}
\input{Chapters/99_Future_Work.tex}

\clearpage

\section*{Acknowledgements}
\addcontentsline{toc}{section}{Acknowledgements}

First and foremost, we would like to thank our supervisors for the support and insight they have given during our research project. They have gravely improven the quality of this report.

We would also like to thank the Cuckoo developers (especially Jurriaan Bremer) who helped us demystify the inner workings of Cuckoo and even helped us resolving the bugs we introduced ourselves during this project.

\clearpage


\addcontentsline{toc}{section}{References}

\bibliographystyle{abbrv}
\bibliography{report}
\clearpage
\section*{Appendix A: Simple Analyzer}

\addcontentsline{toc}{section}{Appendix A: Simple Analyzer}
\begin{lstlisting}
function deep_process_spawn_analyzer(graph)
    foreach vertex in graph
        if vertex.type == "process_spawned"
            if check_depth_in_graph(vertex, 0) > 1
                print "Malicious activity"
            endif
        endif
    endforeach
endfunction

function check_depth_in_graph(vertex, current_depth)
    parents = get_parents_of_vertex(vertex)
    # Actually we need only one parent
    if length_array(parents) > 0
        return check_depth_in_graph(parents[0], current_depth++)
    else
        # No more parents, we're at the root node
        return current_depth
    endif
endfunction
\end{lstlisting}

\clearpage

\end{document}
