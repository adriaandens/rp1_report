This research project focused on the question how the detection of drive-by downloads can be improved by the means of concurrently visiting multiple URLs whilst still being able to determine which URL was responsible for malicious activities. To reach this goal four subquestions have been formulated and answered.

Browsers all implement the ability to concurrently visit multiple URLs in a different way. Some browsers decided to use multiple threads in a single process, but most modern browsers use subprocesses dedicated to a single or a few URLs. When multiple processes are used, it depends on the implementation if that process is directly fetching the webpages or that the main process or an intermediate process is used.

How webpages are retrieved and what the involved APIs are, is highly dependent on the implementation. Two of the examined browsers use the high-level HTTP library provided by the operating system while the other browsers implement their own. Such implementations are, for example, a custom library that is independent from other components of the web browser or an implementation where the network library is tightly integrated in the browser engine.

By monitoring the API calls to the network stack and the process and thread context they are made from, an individual HTTP request can be linked to its source. While other methods are possible, with monitoring, no modifications to the web browser are required while still all information is available.

Additional information that can be used to detect the malicious behaviour includes process, file, registry and other network related API calls. While information sources like network sniffing, syscall observation and other passive techniques could be used, no additional information would be gained.\todo{dat we hebben we wel niet in de tekst gezegd}

Based on this research, this paper proposes an algorithm that enables the possibility to do large-scale drive-by download detection by concurrently visiting multiple URLs whilst still being able to determine the responsible URL for the observed malicious behaviour.\todo{Moet er een regel in over hoe het algoritme werkt?} To validate the working and effectiveness of this algorithm, a proof of concept has been developed for an existing solution for the detection of drive-by downloads. A performance gain of 1639\% for 25 URLs has been observed.
